### PromptTemplate(提示词组件)

​			我们可以自己配置一些提示词模板，使得提示词能够有一个自定义的标准和模板。

```python
template = ("把语句\"{text}\"翻译成{language}")
# 构建提示词模板
prompt_template = PromptTemplate(template=template)
# 将提示词模板格式化具体提示词
prompt = prompt_template.format(text='Hello World', language='中文')
print(prompt);
```

**提示词(message)类型：**

​	user message：用户输入的消息。

​	system message： 模型的目标或角色。

​	assistant message：模型对用户消息的回复。

​	tool message：工具输出的信息。



#### ChatPromptTemplate(多条消息格式化组件)

```python
from llama index.core import ChatPromptTemplate
from llama_index.core.llms import ChatMessage,MessageRole
# 消息记录
message_templates=[
    ChatMessage(content="你是一个专业的语言翻译，负责将用户的语句翻译成 {language}."，role=MessageRole.SYSTEM),
    ChatMessage(content="{text}", role=MessageRole.USER,),
]
# 构建模板
chat_template = ChatPromptTemplate(message_templates=message_templates)
#格式化为文本
prompt = chat_template.format(text="it is such a rainy day", language="中文")
print(prompt)
# 格式化为消息
messages = chat _template.format_messages(text="it is such a rainy day", language="中文")
print(messages)
```



#### RichPromptTemplate(动态定制提示词组件)

```python
from llama_index.core.prompts import RichPromptTemplate
prompt_tmpl = RichPromptTemplate("把用户的问题:\"{{ text }}\"翻译成 {{ language }}")
prompt_str = prompt_tmpl.format(text="it is such a rainy day", language="中文")
prompt_str
```



#### 提示词工程

​		系统接收到用户的风格选择（如“活泼”、“专业”、“简洁”、“幽默”）后，并不是直接给模型传递一个“style=playful”的参数。而是**将这个描述转换成一段结构化的自然语言指令，并拼接到用户原本的请求之前或之后**，形成一个完整的提示词（Prompt），再发送给大模型。

```python
from llama_index.core import PromptTemplate

# 1. 定义一个包含风格占位符的提示词模板
style_template = PromptTemplate("""你是一位{style}的助手。请用{style}的风格回应用户的问题。

用户问题：{query}
助手回复：""")

# 2. 根据用户选择，填充模板
user_style = "活泼幽默"  # 这个值来自前端的下拉框或按钮
user_query = "介绍一下太阳能发电。"

# 3. 生成最终的提示词
final_prompt = style_template.format(style=user_style, query=user_query)

# 4. 将 final_prompt 发送给LLM进行生成
```

- **主流方案（95%以上）：** **提示词拼接**。因为它零成本、灵活、无需重新训练模型，并且对于指令遵循能力强的现代LLM（如GPT-4、Claude、DeepSeek）已经非常有效。
- **系统角色：** 交互系统（前端）的工作是**将用户友好的选择映射为一段精确的、模型能理解的自然语言描述**，并将其嵌入到请求的提示词中。
- **映射是关键：** “活泼”这个词本身可能很模糊。一个优秀的系统后台，可能会将“活泼”映射为一段更详细的指令，例如：“使用轻松愉快的语气，多使用感叹词和emoji，语言口语化，可以加入一些有趣的比喻。” 这种映射关系可能存储在一个配置字典里。

```python
# 一个更精细的风格映射示例
STYLE_PROMPT_MAP = {
    "活泼": "使用轻松愉快的语气，多使用感叹词和emoji，语言口语化，可以加入一些有趣的比喻。",
    "专业": "使用正式、严谨、客观的学术或商业用语，避免口语化表达，结构清晰，分点论述。",
    "简洁": "直接给出核心答案，无需背景铺垫或扩展解释，避免修辞，力求言简意赅。",
    "莎士比亚": "模仿莎士比亚戏剧的文学风格，使用古典的英语表达、比喻和修辞手法。",
}

def build_prompt(query, style_key):
    style_instruction = STYLE_PROMPT_MAP.get(style_key, "")
    return f"{style_instruction}\n\n用户问题：{query}"
```

---

